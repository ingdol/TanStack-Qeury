# 6. useQuery 주요 리턴 데이터

[GitHub - ssi02014/react-query-tutorial: 😃 TanStack Query(aka. react query) 에서 자주 사용되는 개념 정리](https://github.com/ssi02014/react-query-tutorial?tab=readme-ov-file#usequery-주요-리턴-데이터)

```tsx
const {
  data,
  error,
  status,
  fetchStatus,
  isLoading,
  isFetching,
  isError,
  refetch,
  // ...
} = useQuery({
  queryKey: ['user-info'],
  queryFn: getAllSuperHero,
});
```

- `data` : 쿼리 함수가 리턴한 `promise`에서 `resolved` 된 데이터
- `error` : 쿼리 함수에 오류가 발생한 경우, 쿼리에 대한 오류 객체
- `status` : `data` , 쿼리 결과값에 대한 상태를 표현하는 status는 문자열 형태 `3가지` 의 값이 존재함
  - `pending` : 쿼리 데이터가 없고, 쿼리 시도가 아직 완료되지 않은 상태
    - `{ enabled : false }` 상태로 쿼리가 호출되면 이 상태로 시작됨
  - `error` : 에러가 발생했을 때 상태
  - `success` : 쿼리 함수가 오류 없이 요청 성공하고 데이터를 표시할 준비가 된 상태
- `fetchStatus` : `queryFn` 에 대한 정보를 나타냄
  - `fetching` : 쿼리가 현재 실행 중인 상태
  - `paused` : 쿼리를 요청했지만, 잠시 중단된 상태(network mode와 연관)
  - `idle` : 쿼리가 현재 아무 작업도 수행하지 않는 상태
- `isLoading` : `캐싱 된 데이터가 없을 때` 즉, 처음 실행된 쿼리일 때 로딩 여부에 따라 `true/false` 로 반환됨
  - 이는 캐싱 된 데이터가 있다면 로딩 여부에 상관없이 `false`를 반환함
  - `isFetching && isPending` 과 동일함
- `isFetching` : 캐싱 된 데이터가 있더라도 쿼리가 실행되면 로딩 여부에 따라 `true/false` 로 반환됨
- `isSuccess` : 쿼리 요청이 성공하면 `true`
- `isError` : 쿼리 요청 중에 에러가 발생한 경우 `true`
- `refetch` : 쿼리를 수동으로 다시 가져오는 함

### status, fetchStatus 나눠서 다루는 이유

- `fetchStatus` 는 HTTP 네트워크 연결 상태와 좀 더 관련된 상태 데이터임
  - 예를 들어, status가 `success` 상태라면 주로 fetchStatus는 `idle` 상태지만, 백그라운드에서 re-fetch가 발생할 때 `fetching` 상태일 수 있음
  - status가 보통 `loading` 상태일 때 fetchStatus는 주로 `fetching` 를 갖지만, 네트워크 연결이 되어 있지 않는 경우 `paused` 상태를 가질 수 있음
- 결론
  - `status` 는 `data` 가 있는지 없는지에 대한 상태를 의미함
  - `fetchStatus` 는 쿼리 즉, `queryFn 요청` 이 진행 중인지 아닌지에 대한 상태를 의미함
